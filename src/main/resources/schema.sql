DROP TABLE IF EXISTS person, friend, film, likes CASCADE;

CREATE TABLE IF NOT EXISTS person (
    person_id INT NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    email VARCHAR(50) NOT NULL,
    login VARCHAR(50) NOT NULL,
    name VARCHAR(50) NOT NULL,
    birthday DATE NOT NULL,
    CONSTRAINT person_pk PRIMARY KEY (person_id)
);

CREATE TABLE IF NOT EXISTS friend (
    person_one_id INT NOT NULL,
    person_two_id INT NOT NULL,
    as_friend BOOLEAN NOT NULL,
    CONSTRAINT friend_person_one_id FOREIGN KEY(person_one_id) REFERENCES person(person_id) ON DELETE RESTRICT ON UPDATE CASCADE,
    CONSTRAINT friend_person_two_id FOREIGN KEY(person_two_id) REFERENCES person(person_id) ON DELETE RESTRICT ON UPDATE CASCADE
);

CREATE TABLE IF NOT EXISTS film (
	film_id INTEGER NOT NULL GENERATED BY DEFAULT AS IDENTITY,
	name VARCHAR(50) NOT NULL,
	description VARCHAR(200) NOT NULL,
	release_date DATE NOT NULL,
	duration INTEGER NOT NULL,
	CONSTRAINT film_pk PRIMARY KEY(film_id)
);

CREATE TABLE IF NOT EXISTS likes (
	film_id INTEGER NOT NULL,
	person_id INTEGER NOT NULL,
	CONSTRAINT likes_film_fk FOREIGN KEY(film_id) REFERENCES film(film_id) ON DELETE RESTRICT ON UPDATE CASCADE,
	CONSTRAINT likes_user_fk FOREIGN KEY(person_id) REFERENCES person(person_id) ON DELETE RESTRICT ON UPDATE CASCADE
);



